<!DOCTYPE html>
<html>
    <head>
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.2.6 -->

    <!-- Title -->
    
    <title>
        
            基础回顾之C编译过程及预处理器 | 
        
        纸简书生
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon1.jpeg">
    <link rel="icon" sizes="192x192" href="/img/favicon1.jpeg">
    <link rel="apple-touch-icon" href="/img/favicon1.jpeg">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="纸简书生">
    <meta name="description" content="人与人之间的差别在于，一、想得到和想不到，二、想得到且做到的想到但做不到；离开舒适区、自律是方法论。写作，阅读、锻炼、早起、旅行是方法。牢记方法论、价值观，躬行方法，让自己更好！">
    <meta name="keywords" content="纸简书生、iOS、Android、Java">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="纸简书生">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yoursite.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="基础回顾之C编译过程及预处理器 | 纸简书生">
    <meta property="og:description" content="人与人之间的差别在于，一、想得到和想不到，二、想得到且做到的想到但做不到；离开舒适区、自律是方法论。写作，阅读、锻炼、早起、旅行是方法。牢记方法论、价值观，躬行方法，让自己更好！">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
    body, html {
        font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    }

    a {
        color: #00838F;
    }

    .mdl-card__media,
    #search-label,
    #search-form-label:after,
    #scheme-Paradox .hot_tags-count,
    #scheme-Paradox .sidebar_archives-count,
    #scheme-Paradox .sidebar-colored .sidebar-header,
    #scheme-Paradox .sidebar-colored .sidebar-badge{
        background-color: #0097A7 !important;
    }

    /* Sidebar User Drop Down Menu Text Color */
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
    #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
        color: #0097A7 !important;
    }

    #post_entry-right-info,
    .sidebar-colored .sidebar-nav li:hover > a,
    .sidebar-colored .sidebar-nav li:hover > a i,
    .sidebar-colored .sidebar-nav li > a:hover,
    .sidebar-colored .sidebar-nav li > a:hover i,
    .sidebar-colored .sidebar-nav li > a:focus i,
    .sidebar-colored .sidebar-nav > .open > a,
    .sidebar-colored .sidebar-nav > .open > a:hover,
    .sidebar-colored .sidebar-nav > .open > a:focus,
    #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
        color: #0097A7 !important;
    }

    .toTop {
        background: #757575 !important;
    }

    .material-layout .material-post>.material-nav,
    .material-layout .material-index>.material-nav,
    .material-nav a {
        color: #757575;
    }

    #scheme-Paradox .MD-burger-layer {
        background-color: #757575;
    }

    #scheme-Paradox #post-toc-trigger-btn {
        color: #757575;
    }

    .post-toc a:hover {
        color: #00838F;
        text-decoration: underline;
    }
</style>


<!-- Theme Background Related-->

    <style>
        body{
            background-image: url(/img/bg3.png);
        }
    </style>




<!-- Fade Effect -->

    <style>
        .fade {
            transition: all 800ms linear;
            -webkit-transform: translate3d(0,0,0);
            -moz-transform: translate3d(0,0,0);
            -ms-transform: translate3d(0,0,0);
            -o-transform: translate3d(0,0,0);
            transform: translate3d(0,0,0);
            opacity: 1;
        }

        .fade.out{
            opacity: 0;
        }
    </style>


    <script src="/js/jquery.min.js"></script>

    <link rel="stylesheet" href="/css/highlight/solarized-white.css">

    <!-- UC Browser Compatible-->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write('<link rel="stylesheet" href="/css/uc.css">');
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#编译过程"><span class="post-toc-number">1.</span> <span class="post-toc-text">编译过程</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#预处理器"><span class="post-toc-number"></span> <span class="post-toc-text">预处理器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#预处理前的操作"><span class="post-toc-number">1.</span> <span class="post-toc-text">预处理前的操作</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#预处理指令"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">预处理指令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#语言符号及字符型符号"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">语言符号及字符型符号</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#define中使用参数"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">define中使用参数</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用-参数：宏参数创建字符串"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">使用#参数：宏参数创建字符串</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#使用-参数：预处理粘合剂"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">使用##参数：预处理粘合剂</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#和-VA-ARGS-可变宏"><span class="post-toc-number">1.2.3.</span> <span class="post-toc-text">...和__VA_ARGS__:可变宏</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#文件包含"><span class="post-toc-number">2.</span> <span class="post-toc-text">文件包含</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#头文件"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">头文件</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#其他预处理指令"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">其他预处理指令</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#预处理宏"><span class="post-toc-number">2.2.1.</span> <span class="post-toc-text">预处理宏</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#扩展阅读"><span class="post-toc-number">3.</span> <span class="post-toc-text">扩展阅读</span></a></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(http://upload-images.jianshu.io/upload_images/664334-efe31056eaf23961.png)">
    
            <p class="article-headline-p">
                基础回顾之C编译过程及预处理器
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar3.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>纸简书生</strong>
        <span>5月 06, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/recover/">recover</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=基础回顾之C编译过程及预处理器&url=http://yoursite.com//2017/05/06/2017/5/基础回顾之C编译过程及预处理器/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="markdown-Github mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>做技术，越做到后面越觉得基础、底层的才是越难得，也会越有技术含量的。最近做的项目有关音视频、图像处理，涉及到的都死c和c++相关的代码。遇到了问题才发现，c和c++才是通用大法。这两块没学好，那也只有玩一玩应用层、UI这些东西。抽空整理下。<br><a id="more"></a></p>
<h2 id="编译过程"><a href="#编译过程" class="headerlink" title="编译过程"></a>编译过程</h2><p>如果需要弄清整个编译过程，那还得好好复习下编译原理。这里只是通过一个小例子讨论大致过程。</p>
<p>准备好一个helloworld的c文件。内容最好简单如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Hello World!\n"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>编译命令</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ gcc helloworld.c // 编译</div><div class="line">$ ./a.out // 执行</div><div class="line">Hello World!</div></pre></td></tr></table></figure>
<p>gcc命令其实依次执行了四步操作：</p>
<ol>
<li><p>预处理(Preprocessing)</p>
<ul>
<li>预处理用于将所有的#include头文件以及宏定义替换成其真正的内容，预处理之后得到的仍然是文本文件，但文件体积会大很多。</li>
<li>命令: <code>gcc -E -I./ helloworld.c -o helloworld.i</code> 或者直接用<code>cpp helloworld.c -I./ -o helloworld.i</code></li>
<li>参数说明：<ul>
<li><code>-E</code>是让编译器在预处理之后就退出，不进行后续编译过程；</li>
<li><code>-I</code>指定头文件目录，这里指定的是我们自定义的头文件目录；</li>
<li><code>-o</code>指定输出文件名。</li>
</ul>
</li>
<li><p>经过预处理之后代码体积会大很多。如下是预处理之后的部分内容。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line"># 1 "helloworld.c"</div><div class="line"># 1 "&lt;built-in&gt;" 1</div><div class="line"># 1 "&lt;built-in&gt;" 3</div><div class="line"># 330 "&lt;built-in&gt;" 3</div><div class="line"># 1 "&lt;command line&gt;" 1</div><div class="line"># 1 "&lt;built-in&gt;" 2</div><div class="line"># 1 "helloworld.c" 2</div><div class="line">typedef unsigned char __uint8_t;</div><div class="line">typedef short __int16_t;</div><div class="line">typedef unsigned short __uint16_t;</div><div class="line">typedef int __int32_t;</div><div class="line">typedef unsigned int __uint32_t;</div><div class="line">typedef long long __int64_t;</div><div class="line">typedef unsigned long long __uint64_t;</div><div class="line">typedef struct _opaque_pthread_attr_t __darwin_pthread_attr_t;</div><div class="line">typedef struct _opaque_pthread_cond_t __darwin_pthread_cond_t;</div><div class="line">typedef struct _opaque_pthread_condattr_t __darwin_pthread_condattr_t;</div><div class="line">typedef unsigned long __darwin_pthread_key_t;</div><div class="line">typedef struct _opaque_pthread_mutex_t __darwin_pthread_mutex_t;</div><div class="line">typedef struct _opaque_pthread_mutexattr_t __darwin_pthread_mutexattr_t;</div><div class="line">FILE *fopen(const char * restrict __filename, const char * restrict __mode) __asm("_" "fopen" );</div><div class="line"></div><div class="line">int fprintf(FILE * restrict, const char * restrict, ...) __attribute__((__format__ (__printf__, 2, 3)));</div><div class="line">int fputc(int, FILE *);</div><div class="line">int fputs(const char * restrict, FILE * restrict) __asm("_" "fputs" );</div><div class="line">size_t fread(void * restrict __ptr, size_t __size, size_t __nitems, FILE * restrict __stream);</div><div class="line">FILE *freopen(const char * restrict, const char * restrict,</div><div class="line">                 FILE * restrict) __asm("_" "freopen" );</div><div class="line">int fscanf(FILE * restrict, const char * restrict, ...) __attribute__((__format__ (__scanf__, 2, 3)));</div><div class="line">int fseek(FILE *, long, int);</div><div class="line">int fsetpos(FILE *, const fpos_t *);</div><div class="line">long ftell(FILE *);</div><div class="line">size_t fwrite(const void * restrict __ptr, size_t __size, size_t __nitems, FILE * restrict __stream) __asm("_" "fwrite" );</div><div class="line">int getc(FILE *);</div><div class="line">int getchar(void);</div><div class="line">char *gets(char *);</div><div class="line">void perror(const char *);</div><div class="line">int printf(const char * restrict, ...) __attribute__((__format__ (__printf__, 1, 2)));</div><div class="line">int putc(int, FILE *);</div><div class="line">int putchar(int);</div><div class="line">int puts(const char *);</div><div class="line">int remove(const char *);</div><div class="line">int rename (const char *__old, const char *__new);</div><div class="line">void rewind(FILE *);</div><div class="line">int scanf(const char * restrict, ...) __attribute__((__format__ (__scanf__, 1, 2)));</div><div class="line">void setbuf(FILE * restrict, char * restrict);</div><div class="line">int setvbuf(FILE * restrict, char * restrict, int, size_t);</div><div class="line">int sprintf(char * restrict, const char * restrict, ...) __attribute__((__format__ (__printf__, 2, 3))) __attribute__((__availability__(swift, unavailable, message="Use snprintf instead.")));</div><div class="line">int sscanf(const char * restrict, const char * restrict, ...) __attribute__((__format__ (__scanf__, 2, 3)));</div><div class="line">FILE *tmpfile(void);</div><div class="line"></div><div class="line">__attribute__((__availability__(swift, unavailable, message="Use mkstemp(3) instead.")))</div><div class="line"></div><div class="line">__attribute__((deprecated("This function is provided for compatibility reasons only.  Due to security concerns inherent in the design of tmpnam(3), it is highly recommended that you use mkstemp(3) instead.")))</div><div class="line">... 中间很多内容这里省略</div><div class="line"></div><div class="line">extern int __vsnprintf_chk (char * restrict, size_t, int, size_t,</div><div class="line">       const char * restrict, va_list);</div><div class="line"># 499 "/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.12.sdk/usr/include/stdio.h" 2 3 4</div><div class="line"># 2 "helloworld.c" 2</div><div class="line">int main()&#123;</div><div class="line">    printf("Hello World!\n");</div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<ol>
<li><p>编译(Compilation), </p>
<ul>
<li><strong>这里的编译不是指程序从源文件到二进制程序的全部过程，而是指将经过预处理之后的程序转换成特定汇编代码(assembly code)的过程。</strong></li>
<li>命令:gcc -S -I./ helloworld.c -o helloworld.s</li>
<li>参数:<code>-S</code>为了编译之后停止。后面的两个参数含义和预处理的时候一样</li>
<li><p>经过编译之后的内容如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">	.section	__TEXT,__text,regular,pure_instructions</div><div class="line">	.macosx_version_min 10, 12</div><div class="line">	.globl	_main</div><div class="line">	.p2align	4, 0x90</div><div class="line">_main:                                  ## @main</div><div class="line">	.cfi_startproc</div><div class="line">## BB#0:</div><div class="line">	pushq	%rbp</div><div class="line">Ltmp0:</div><div class="line">	.cfi_def_cfa_offset 16</div><div class="line">Ltmp1:</div><div class="line">	.cfi_offset %rbp, -16</div><div class="line">	movq	%rsp, %rbp</div><div class="line">Ltmp2:</div><div class="line">	.cfi_def_cfa_register %rbp</div><div class="line">	subq	$16, %rsp</div><div class="line">	leaq	L_.str(%rip), %rdi</div><div class="line">	movl	$0, -4(%rbp)</div><div class="line">	movb	$0, %al</div><div class="line">	callq	_printf</div><div class="line">	xorl	%ecx, %ecx</div><div class="line">	movl	%eax, -8(%rbp)          ## 4-byte Spill</div><div class="line">	movl	%ecx, %eax</div><div class="line">	addq	$16, %rsp</div><div class="line">	popq	%rbp</div><div class="line">	retq</div><div class="line">	.cfi_endproc</div><div class="line"></div><div class="line">	.section	__TEXT,__cstring,cstring_literals</div><div class="line">L_.str:                                 ## @.str</div><div class="line">	.asciz	&quot;Hello World!\n&quot;</div><div class="line"></div><div class="line"></div><div class="line">.subsections_via_symbols</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>汇编(Assemble), </p>
<ul>
<li>汇编过程将上一步的汇编代码转换成机器码(machine code)，这一步产生的文件叫做目标文件，是二进制格式。如果有多个文件需要<strong>为每一个源文件产生一个目标文件。</strong></li>
<li>命令:as helloworld.s -o helloworld.o 或者 gcc -c helloworld.s -o helloworld.o</li>
</ul>
</li>
<li>链接(Linking)。<ul>
<li>链接过程将多个目标文以及所需的库文件(.so等)链接成最终的可执行文件(executable file)。</li>
<li>命令:ld -o helloworld.out helloworld.o <code>**.o</code> <code>**.o</code>。格式其实就是 <code>ld(选项)(参数)</code>参数就是需要连接的目标文件。由于这里没有生成其他目标文件，所以这段不会连接成功的。具体的命令可以看这里<a href="http://man.linuxde.net/ld" target="_blank" rel="external">ld命令</a></li>
</ul>
</li>
</ol>
<p>走完上面的步骤可以得到如下几个文件。<br><img src="http://upload-images.jianshu.io/upload_images/664334-efe31056eaf23961.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>其实我们平时写代码的到得到可执行文件的整个过程可以用下图来概括。<br><img src="https://www3.ntu.edu.sg/home/ehchua/programming/cpp/images/C_DevelopmentProcesses.png" alt=""></p>
<h1 id="预处理器"><a href="#预处理器" class="headerlink" title="预处理器"></a>预处理器</h1><p>上面把基本的编译过程讲完了，现在就开始进入今天的正题。</p>
<h2 id="预处理前的操作"><a href="#预处理前的操作" class="headerlink" title="预处理前的操作"></a>预处理前的操作</h2><p>再进行预处理前，编译器会对源代码记性一些翻译过程。其中有几点需要知道:</p>
<ul>
<li>源代码中的资费映射到元字符集。使得C外观更加国际化</li>
<li>预处理表达式的长度为一逻辑行。</li>
<li><p>查找反斜杠后紧跟换行符的实例并删除。也即是预处理会删除反斜杠和换行符的组合。</p>
<ul>
<li><p>类似</p>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">printf</span>(<span class="string">"Hello, \</span></div><div class="line">               World!\n");</div></pre></td></tr></table></figure>
<p>  两行物理行变为一行<code>printf(&quot;Hello,World!\n&quot;);</code>经过测试在Xcode中会上面的形式会比项目多很多空格。</p>
<ul>
<li><strong>其实这就是为什么我们能够用宏定义定义函数的原理。</strong></li>
<li>文本划分为预处理语言符号、空白字符及注释序列。<strong>注意编译器会有空格代替注释</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="预处理指令"><a href="#预处理指令" class="headerlink" title="预处理指令"></a>预处理指令</h3><p>所有预处理指令都是以<code>#</code>开头。关于<code>#define</code>和<code>const</code>定义常量的区别也是需要值得注意的地方。<code>#define</code>做的是暴力替换，而<code>const</code>是针对性的。</p>
<h4 id="语言符号及字符型符号"><a href="#语言符号及字符型符号" class="headerlink" title="语言符号及字符型符号"></a>语言符号及字符型符号</h4><ul>
<li>字符型符号:额外的空格当成替换文本的一部分,空格也是主体的一部分。</li>
<li>语言符号:空格只是分隔主体的符号。</li>
</ul>
<p>例子<code>#define TEST 4  *  8</code></p>
<ul>
<li>字符型符号将TEST替换为<code>4  *  8</code></li>
<li>语言符号将TEST替换为<code>4 * 8</code></li>
</ul>
<p><strong>C编译器把宏主体当成的是字符型符号</strong></p>
<p><strong>判断宏定义想不相同通过语言定义符号来确定。比如#define TEST 4<em>8和上面的就不是相同的宏定义因为它只有一个语言符号4`</em>`8。上面有三个分别是4、空格、8</strong></p>
<h3 id="define中使用参数"><a href="#define中使用参数" class="headerlink" title="define中使用参数"></a>define中使用参数</h3><p>使用参数很简单，就是<code>#define TEST(X) X*X</code>。规则如下：<br><img src="http://upload-images.jianshu.io/upload_images/664334-61ab9dcfa2b0079a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>特别需要注意的是宏参数和函数参数的区别，宏参数是进行严格的特换。这如果使用不懂就会出现非常严重的错误。</strong></p>
<h4 id="使用-参数：宏参数创建字符串"><a href="#使用-参数：宏参数创建字符串" class="headerlink" title="使用#参数：宏参数创建字符串"></a>使用<code>#</code>参数：宏参数创建字符串</h4><table>
<thead>
<tr>
<th>宏定义</th>
<th>调用</th>
<th>结果</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>#define TESTPF(x) printf(&quot;test &quot;#x&quot; * &quot;#x&quot;=%d\n&quot;,(x)*(x));</code></td>
<td><code>TESTPF(5 + 5)</code></td>
<td><code>test 5 + 5 * 5 + 5=100</code></td>
</tr>
<tr>
<td><code>#define TESTPF(x) printf(&quot;test x * x=%d\n&quot;,(x)*(x));</code></td>
<td><code>TESTPF(5 + 5);</code></td>
<td><code>test x * x=100</code></td>
</tr>
</tbody>
</table>
<p>可以看到<code>#</code>参数的作用就是把字符串中的x也进行了替换。</p>
<h4 id="使用-参数：预处理粘合剂"><a href="#使用-参数：预处理粘合剂" class="headerlink" title="使用##参数：预处理粘合剂"></a>使用<code>##</code>参数：预处理粘合剂</h4><p><code>##</code>作用是把两个语言符号组合为单个语言符号。<br>例子：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> XNAME(n) x##n</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PRINT_XN(n) printf(<span class="meta-string">"x"</span>#n<span class="meta-string">" = %d \n"</span>);</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">XNAME</span><span class="params">(<span class="number">1</span>)</span> </span>= <span class="number">1</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">XNAME</span><span class="params">(<span class="number">2</span>)</span> </span>= <span class="number">2</span>;</div><div class="line">PRINT_XN(<span class="number">1</span>);</div><div class="line">PRINT_XN(<span class="number">2</span>);</div><div class="line"></div><div class="line">结果：</div><div class="line">x1 = <span class="number">1606416096</span> </div><div class="line">x2 = <span class="number">4352</span></div></pre></td></tr></table></figure>
<h4 id="和-VA-ARGS-可变宏"><a href="#和-VA-ARGS-可变宏" class="headerlink" title="...和__VA_ARGS__:可变宏"></a><code>...</code>和<code>__VA_ARGS__</code>:可变宏</h4><p>这个其实在iOS开发中还是用得挺多的。</p>
<p>例子</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PR(...) printf(__VA_ARGS__)</span></div><div class="line"></div><div class="line">PR(<span class="string">"DD"</span>);</div><div class="line">PR(<span class="string">"D=%d,F=%d\n"</span>,<span class="number">12</span>,<span class="number">22</span>);</div><div class="line"></div><div class="line">结果：</div><div class="line">DDD=<span class="number">12</span>,F=<span class="number">22</span></div></pre></td></tr></table></figure>
<p><strong>特别注意。省略号必须在最后一个参数位置。根据这个道理，有些同学可能就能联想到某些语言可变参数的位置为什么一定要在最后把。比如python</strong></p>
<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><p>预处理器发现<code>#include</code>指令后，会寻找跟在后面的文件，把这个文件中的内容包含到当前文件中。<br><img src="http://upload-images.jianshu.io/upload_images/664334-bc5310a01554942b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h3><p>OC中有.h和.m文件，这和C里面的.h和.c是同一个道理。所以这里就不多说了。具体看图。<br><img src="http://upload-images.jianshu.io/upload_images/664334-eccfc5b06d18db96.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h3 id="其他预处理指令"><a href="#其他预处理指令" class="headerlink" title="其他预处理指令"></a>其他预处理指令</h3><ul>
<li><code>#undef</code>取消已定义的宏</li>
<li><code>#if</code>如果给定条件为真，则编译下面代码</li>
<li><code>#elif</code>如果前面的#if给定条件不为真，当前条件为真，则编译下面代码</li>
<li><code>#endif</code>结束一个<code>#if……#else</code>条件编译块</li>
<li><code>#ifdef</code>如果宏已经定义，则编译下面代码</li>
<li><code>#ifndef</code>如果宏没有定义，则编译下面代码</li>
<li><code>#pragma</code>指令没有正式的定义。编译器可以自定义其用途。典型的用法是禁止或允许某些烦人的警告信息。</li>
</ul>
<p>上面这些预处理指令，用得比较频繁。大家应该不陌生。还多一些平时用得不多的。</p>
<ul>
<li><code>#line</code>指令可以改变编译器用来指出警告和错误信息的文件号和行号。</li>
<li><code>#error</code>停止编译并显示错误信息</li>
</ul>
<h4 id="预处理宏"><a href="#预处理宏" class="headerlink" title="预处理宏"></a>预处理宏</h4><p>C标准制定的一些预处理宏。<br><img src="http://upload-images.jianshu.io/upload_images/664334-9cfdabf2edcdb231.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>额外补充一个<code>__func__</code>预定义标识符。这个是C99标准提供的。用于标识当前函数。</p>
<p><strong>上面这些预处理宏经常用于打印一些日志信息。</strong></p>
<h2 id="扩展阅读"><a href="#扩展阅读" class="headerlink" title="扩展阅读"></a>扩展阅读</h2><p><a href="https://www3.ntu.edu.sg/home/ehchua/programming/cpp/c0_Introduction.html" target="_blank" rel="external">C programming Tutorial Introduction to C Programming (for Novices &amp; First-Time Programmers)</a><br><a href="http://www.cnblogs.com/zi-xing/p/4550246.html" target="_blank" rel="external">C/C++预处理指令#define,#ifdef,#ifndef,#endif…</a></p>

    

    
</div>


                

                <!-- Post Comments -->
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/04/30/2017/4/基础回顾之存储类、链接与内存管理/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar3.png" alt="纸简书生's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        weslywxl@gmail.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    <li id="sidebar-first-li">
        <a href="/" target="_self">
            <i class="material-icons sidebar-material-icons">home</i>
            主页
        </a>
    </li>

    <!-- I'm Feeling Lucky -->
    <!--
    <li class="dropdown">
        <a href="" target="_self">
            <i class="material-icons sidebar-material-icons">explore</i>
             sidebar.imlucky
        </a>
    </li>
    -->

    <!-- Archives  -->
    <li class="dropdown">
        <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
            <i class="material-icons sidebar-material-icons">inbox</i>
             归档
            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">
            <li>
            <a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">12</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">1</span></a>
        </ul>
    </li>

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Android/">Android<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Blog/">Blog<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Recover/">Recover<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS/">iOS<span class="sidebar_archives-count">8</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS/animation/">animation<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS/audio/">audio<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS/face-recognize/">face recognize<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS/issue/">issue<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/iOS/recover/">recover<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/language/">language<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/language/base/">base<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/mac/">mac<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/mac/tool/">tool<span class="sidebar_archives-count">1</span></a>
            </ul>
        </li>
    

    <!-- Divider -->
    <li class="divider"></li>


    <!-- Pages  -->
  	

    <!-- Article Numebr  -->
    <li>
        <a href="/archives">
            文章总数
            <span class="sidebar-badge">14</span>
        </a>
    </li>
</ul>


        <!-- Sidebar Divider -->
        <div class="sidebar-divider"></div>

        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Theme Material -->
<a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
        主题 - Material
        <span class="sidebar-badge badge-circle">i</span>
    </div>
</a>

<!-- Help & Support -->
<!--
<a href="mailto:hiviosey@gmail.com" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
    sidebar.help
    <span class="mdl-button__ripple-container">
      <span class="mdl-ripple"></span>
    </span>
  </div>
</a>
-->

<!-- Feedback -->
<!--
<a href="https://github.com/viosey/hexo-theme-material/issues" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.feedback
                    <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>
-->

<!-- Abount Theme -->
<!--
<a href="https://blog.viosey.com/index.php/Material.html" target="_blank" class="sidebar-footer-text-a">
    <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
         sidebar.about_theme
        <span class="mdl-button__ripple-container"><span class="mdl-ripple"></span></span></div>
</a>-->

    </div>

    <!-- Sidebar Sponsor -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;纸简书生
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/highlight.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();

    $('#nprogress .bar').css({
        'background': '#FF4081'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #FF4081, 0 0 15px #FF4081'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#FF4081',
        'border-left-color': '#FF4081'
    });

    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>



    <script src="/js/smoothscroll.js"></script>











<!-- Swiftye -->


<!-- Local Search-->

    <script>
    var searchFunc = function(path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: 'xml',
            success: function( xmlResponse ) {
                // get the contents from search data
                var datas = $( 'entry', xmlResponse ).map(function() {
                    return {
                        title: $( 'title', this ).text(),
                        content: $('content',this).text(),
                        url: $( 'url' , this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function() {
                    var str='<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function(data) {
                        var isMatch = true;
                        var content_index = [];
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                        var data_url = data.url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if(data_title != '' && data_content != '') {
                            keywords.forEach(function(keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if( index_title < 0 && index_content < 0 ) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += '<li><a href="'+ data_url +'" class="search-result-title" target="_blank">'+ data_title;
                            var content = data.content.trim().replace(/<[^>]+>/g, '');
                            if (first_occur >= 0) {
                                // cut out characters
                                var start = first_occur - 6;
                                var end = first_occur + 6;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 10;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, 'gi');
                                    match_content = match_content.replace(regS, '<em class="search-keyword">'+keyword+'</em>');
                                })
                                str += '<p class="search-result">' + match_content +'...</p>' +'</a>';
                            }
                        }
                    });
                    $resultContent.innerHTML = str;
                });
            }
        });
    }
</script>


    <script>
        var inputArea = document.querySelector('#search');
        var getSearchFile = function() {
            var path = 'search.xml';
            searchFunc(path, 'search', 'local-search-result');
        }

        if(inputArea) {
            inputArea.onfocus = function() {
                getSearchFile();
            }
        }
    </script>


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
